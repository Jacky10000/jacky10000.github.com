<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			canvas{
				box-shadow: 0px 0px 10px 2px gray;
				padding: 20px;
			}
		</style>
	</head>
	<body>
		<canvas id="canvas" width="700" height="100"></canvas>
	</body>
	<script type="text/javascript">
	var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];
		
	let canvas = document.getElementById("canvas");
	let cxt    = canvas.getContext("2d");
	var R = canvas.height/20 - 1;				//小球的半径高度
	let balls = [];															//存储小球坐标的数组
	let data = [];															//存储时间的数组
	var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());				//正则的exec可以返回符合要求的字符串，且再返回正则中每个()中匹配项
	data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
	
	function time(){
		cxt.clearRect(0,0,700,100);										//重置画布
		var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
		var NewData = [];												//生成新的数组时间
		NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
		for(var i = data.length-1; i >=0 ; i--){				//时间发生变化 
			if(NewData[i] !== data[i]){
				addBalls(i,NewData[i])							//将变化的位置的数组使用addBalls
			}
		}	
		data = NewData;											//把新的时间给到data
		for(let i=0;i<8;i++){									//绘制几个黑色的数字
			renderDigit(i,data[i])
		}
		moveBalls();											//移动所有的彩色球
		renderBall();
		
	}
    time();
	setInterval(time,50)
	
	//根据某个数字来进行绘制
	function renderDigit(index,num){
		for(var i = 0; i < 10; i++){							//每个数字有10排
			for(var j = 0; j < 7; j++){							//每个数字有7列
				if(digit[num][i][j] == 1){						//数字图形中为0的坐标不绘制
					cxt.beginPath();
					cxt.fillStyle = "black";
					//14*(R+2)*index		整个数字所在的位置
					//j*2*(R+1)+(R+1)		当前数字中点的位置列坐标
					//i*2*(R+1)+(R+1)		当前数字中点的位置横坐标
					cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
					cxt.fill();
					cxt.closePath();
				}
			}
		}		
	}	
	
	//增加小球
	function addBalls(index,num){
		var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];		//小球的随机色
		for(var i = 0; i < digit[num].length; i++){
			for(var j = 0; j < digit[num][i].length; j++){
				if(digit[num][i][j] == 1){
					var ball = {
						x:14*(R+2)*index + j*2*(R+1)+(R+1),
						y:i*2*(R+1)+(R+1),
						stepX:Math.floor(Math.random() * 4 -2),			//球左右的速度，-2到2之间	
						stepY:-2*(Math.ceil(Math.random()*2)),				//球下落速度2，4，6
						color:colorArray[Math.floor(Math.random()*colorArray.length)]	//取一个颜色
					};
					balls.push(ball);			
				}
			}
		}	
	}
	//移动小球的位移，每次横向
	function moveBalls(){
		for(var i = 0; i < balls.length; i++){
			balls[i].stepY += 1;									//调节降落的速度(开始彩色小球是往上，很快往下)
			balls[i].x += balls[i].stepX;
			balls[i].y += balls[i].stepY;	
			if(balls[i].x > 700 + R || balls[i].y > 100 + R){			//球超出边界，不进行绘制
				balls.splice(i,1);
				i--;
			}				
		}
	}		
	
	/*绘制小球的方法*/
	function renderBall(){
		for(var i = 0; i < balls.length; i++){
			cxt.beginPath();
			cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
			cxt.fillStyle = balls[i].color;
			cxt.closePath();
			cxt.fill();				
		}
	}	
		
	</script>
</html>
